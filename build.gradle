group 'com.rostegg.kotlin.webextensions'
version '1.0-SNAPSHOT'

buildscript {
    ext.kotlin_version = '1.2.20'

    repositories {
        mavenCentral()
    }
    dependencies {
        classpath "org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"
    }

}

allprojects {

    if (!project.name.startsWith("proxy")){
        apply plugin: 'kotlin-dce-js'
    }

    apply plugin: 'kotlin2js'

    repositories {
        mavenCentral()
        maven { url 'https://jitpack.io' }
    }

    dependencies {
        compile "org.jetbrains.kotlin:kotlin-stdlib-js:$kotlin_version"
    }


}

task mergeScripts {
        doLast{
            def toConcatenate = files("${project.rootDir}/background-script/build/kotlin-js-min/main/kotlin.js", "${project.rootDir}/proxy/build/classes/main/proxy.js")
            def outputFileName = "${project.rootDir}/proxy/build/classes/main/proxy-settings.js"
            def output = new File(outputFileName)
            output.write('')
            toConcatenate.each { f -> output << f.text }
        }
}




